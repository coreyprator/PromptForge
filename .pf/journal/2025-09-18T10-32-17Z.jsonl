{"op": "write", "path": "G:\\My Drive\\Code\\Python\\PromptForge\\v2\\scripts\\scenario_pf_link_and_log_quotes.ps1", "before_sha": null, "after_sha": "26f9746d5aaa8726ca84976c3a68eb8535a25f07250b6e3a40a85d2f58317c22", "before_bytes": null, "after_bytes": "[CmdletBinding()]\nparam([string]$ProjectRoot)\nSet-StrictMode -Version Latest\n$ErrorActionPreference='Stop'\nif ($PSBoundParameters.ContainsKey('ProjectRoot') -and $ProjectRoot) { Set-Location -LiteralPath $ProjectRoot }\n\n# 1) Broaden PATH_RE to allow spaces + UNC\n$utils = Join-Path (Get-Location) 'pf\\utils.py'\nif (-not (Test-Path -LiteralPath $utils)) { throw \"Not found: $utils\" }\n$src = Get-Content -LiteralPath $utils -Raw -Encoding UTF8\n$pattern = 'PATH_RE\\s*=\\s*re\\.compile\\([^\\)]*\\)'\n$replacement = 'PATH_RE = re.compile(r\"((?:[A-Za-z]:[\\\\/]|\\\\\\\\[^\\\\s/\\\\:*?\\\"<>|]+[\\\\/]|/)[^\\\\r\\\\n]+)\")'\n$dst = [regex]::Replace($src, $pattern, $replacement)\nif ($dst -ne $src) { Set-Content -Encoding utf8NoBOM -LiteralPath $utils -Value $dst; Write-Host 'Patched PATH_RE in pf\\\\utils.py' } else { Write-Host 'PATH_RE already patched' }\n\n# 2) Quote path prints in UI so links grab the full string\n$ui = Join-Path (Get-Location) 'pf\\ui_app.py'\nif (Test-Path -LiteralPath $ui) {\n  $u = Get-Content -LiteralPath $ui -Raw -Encoding UTF8\n  $u = $u -replace 'Project root:\\s*\\{self\\.project_root\\}', 'Project root: \"{self.project_root}\"'\n  $u = $u -replace 'Switched project\\s*[\\u2192\\-]>?\\s*\\{target\\}', 'Switched project → \"{target}\"'\n  $u = $u -replace 'Switched project\\s*[\\u2192\\-]>?\\s*\\{self\\.project_root\\}', 'Switched project → \"{self.project_root}\"'\n  Set-Content -Encoding utf8NoBOM -LiteralPath $ui -Value $u\n  Write-Host 'Patched pf\\\\ui_app.py path log formatting (quoted)'\n} else {\n  Write-Host 'pf\\\\ui_app.py not found here; skipped quoting patch.'\n}\n\nWrite-Host 'Done. Relaunch PF (run_ui) to activate.'\n"}
